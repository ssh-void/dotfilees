# ~/.bash_functions

function mcd() {
	mkdir -p "$1" && cd "$1";
}

tmuxgo() { # select_tmux_window
	if [[ -z "$1" ]]; then
	echo "Usage: select_tmux_window <window_number>"
	return 1
	fi
	tmux select-window -t "$1"
}

tms() {
	local session=$(tmux list-sessions -F "#{session_name}" | fzy -l 7)
	[[ -n "$session" ]] && tmux switch-client -t "$session" || tmux attach -t "$session"
}

gtfr() {
	gtts-cli -l fr --slow "$1" | oniux mpv --no-config --speed=1.5 --no-video --af-add="volume=2" --term-osd-bar --ytdl-format=bestaudio --loop=inf --user-agent="Mozilla/5.0 (X11; Linux x86_64; rv:142.0) Gecko/20100101 Firefox/142.0" --input-conf=<(echo -e "UP add speed 0.1\nDOWN add speed -0.1") -
}

gtar() {
	gtts-cli -l ar --slow "$1" | oniux mpv --no-config --no-video --af-add="volume=2" --term-osd-bar --ytdl-format=bestaudio --loop=inf --user-agent="Mozilla/5.0 (X11; Linux x86_64; rv:142.0) Gecko/20100101 Firefox/142.0" --input-conf=<(echo -e "UP add speed 0.1\nDOWN add speed -0.1") -
}

gten() {
	gtts-cli -l en --slow "$1" | oniux mpv --no-config --no-video --af-add="volume=2" --term-osd-bar --ytdl-format=bestaudio --loop=inf --user-agent="Mozilla/5.0 (X11; Linux x86_64; rv:142.0) Gecko/20100101 Firefox/142.0" --input-conf=<(echo -e "UP add speed 0.1\nDOWN add speed -0.1") -
}

mpvtormp3() {
	oniux mpv --no-config \
	--no-video \
	--af-add="volume=2" \
	--term-osd-bar \
	--loop=inf \
	--ytdl-raw-options=format='ba*[ext=m4a]/ba*/b[ext=mp4]/b',geo-bypass-country=FR,user-agent='Mozilla/5.0 (X11; Linux x86_64; rv:142.0) Gecko/20100101 Firefox/142.0',downloader-args='ffmpeg:-loglevel error -stats -timeout 10000000 -reconnect 1 -reconnect_streamed 1 -reconnect_delay_max 5',sponsorblock-mark=all,sponsorblock-remove=all \
	--user-agent="Mozilla/5.0 (X11; Linux x86_64; rv:142.0) Gecko/20100101 Firefox/142.0" \
	--input-conf=<(echo -e "UP add speed 0.1\nDOWN add speed -0.1") \
	"$@"
}
mpvmp3() {
	mpv --no-config --no-video \
	--af-add="volume=2" \
	--term-osd-bar \
	--loop=inf \
	--ytdl-raw-options=format='ba*[ext=m4a]/ba*/b[ext=mp4]/b',geo-bypass-country=FR,user-agent='Mozilla/5.0 (X11; Linux x86_64; rv:142.0) Gecko/20100101 Firefox/142.0',downloader-args='ffmpeg:-loglevel error -stats -timeout 10000000 -reconnect 1 -reconnect_streamed 1 -reconnect_delay_max 5',sponsorblock-mark=all,sponsorblock-remove=all \
	--user-agent="Mozilla/5.0 (X11; Linux x86_64; rv:142.0) Gecko/20100101 Firefox/142.0" \
	--input-conf=<(echo -e "UP add speed 0.1\nDOWN add speed -0.1") \
	"$@"
}

nettoie_texte() {
    sed 's/\[[^]]*\]//g; s/"//g'
}

rename_random() {
    for f in "$@"; do
        # Vérifie que le fichier existe
        [ -f "$f" ] || { echo "Fichier introuvable: $f"; continue; }

        num=$(echo "$f" | cut -d'-' -f1 | tr -d ' ')   # extrait le numéro avant '-'
        ext="${f##*.}"                                # extension
        rand=$(head -c 100 /dev/random | tr -dc 'a-zA-Z0-9' | head -c7)  # 7 chars aléatoires

        newname="${num}-${rand}.${ext}"
        mv -- "$f" "$newname"
        echo "Renommé: $f -> $newname"
    done
}
##############
# nwipedod ...
##############

# nwipedod  /dev/sdb
nwipedod () {
 doas nwipe --method dod522022m --rounds 1 --autonuke --nosignals --logfile ~/nwipessd.log "$1"
}

nwipeops2 () {
 doas nwipe --method ops2 --rounds 1 --autonuke --nosignals --logfile ~/nwipessd.log "$1"
}

#############
# whisper ...
#############

whisperEntiny () {
whisper "$@" --model tiny.en --threads 8 --language English -f vtt --device cpu
}

whisperFrtiny () {
whisper "$@" --model tiny --threads 8 --language French -f vtt --device cpu
}

whisperEnsmall () {
whisper "$@" --model small.en --threads 8 --language English -f vtt --device cpu
}

whisperFrsmall () {
whisper "$@" --model small --threads 8 --language French -f vtt --device cpu
}


#############
# zulucrypt ...
#############

zulucryptvera () {
rand=$(head -c 100 /dev/random | tr -dc 'a-zA-Z0-9' | head -c7)
truncate -s "$1" ~/verazulu-$rand.hc
doas zuluCrypt-cli -c -t vera -d ~/verazulu-$rand.hc -z ntfs -g "/dev/urandom.aes:twofish:serpent.xts-plain64.512.sha512"
}

zuluopenvera () {
    rand=$(head -c 100 /dev/random | tr -dc 'a-zA-Z0-9' | head -c5)
    doas cryptsetup open --type tcrypt --veracrypt ~/$(ls verazulu*.hc | fzy -i -l 10) verazulu-$rand.hc
    mkdir -p /media/verazulu-$rand.hc
    doas mount -o rw /dev/mapper/verazulu-$rand.hc /media/verazulu-$rand.hc
}

vlcipt () {
    streamlink "$1" best --player vlc

}
