!pip install yt-dlp # tested!
!apt update
!apt upgrade -y
!apt install git aria2 inxi nvtop htop tor -y # tested!
#!apt install ffmpeg
#!apt install -y nvidia-driver-525 nvidia-cuda-toolkit
git clone https://git.videolan.org/git/ffmpeg/nv-codec-headers.git
cd nv-codec-headers && sudo make install && cd –
git clone https://git.ffmpeg.org/ffmpeg.git ffmpeg/
sudo apt-get install build-essential yasm cmake libtool libc6 libc6-dev unzip wget libnuma1 libnuma-dev
./configure --enable-nonfree --enable-cuda-nvcc --enable-libnpp --extra-cflags=-I/usr/local/cuda/include --extra-ldflags=-L/usr/local/cuda/lib64 --disable-static --enable-shared
make -j 8
# https://docs.nvidia.com/video-technologies/video-codec-sdk/12.0/ffmpeg-with-nvidia-gpu/index.html
ffmpeg -y -vsync 0 -hwaccel cuda -hwaccel_output_format cuda -i input.mp4 -c:a copy -c:v h264_nvenc -b:v 5M output.mp4
ffmpeg -y -vsync 0 -hwaccel cuda -hwaccel_output_format cuda –resize 1280x720 -i input.mp4 -c:a copy -c:v h264_nvenc -b:v 5M output.mp4
sudo make install
!nvidia-smi
!nvidia-xconfig --query-gpu-info
!yt-dlp --yes-playlist \
-f "bv*[ext=mp4]+ba*[ext=m4a]/bv*+ba*/b[ext=mp4]/b" \
--no-embed-metadata --no-add-metadata --no-write-info-json --no-embed-info-json --no-write-description \
--no-warnings --no-mtime --no-part --no-overwrites --no-abort-on-error --rm-cache-dir \
--sponsorblock-mark all --sponsorblock-remove all \
--embed-thumbnail --convert-thumbnails jpg --ppa "EmbedThumbnail+ffmpeg:-loglevel error -stats" --embed-chapters \
--ignore-errors --continue --retries 20 --retry-sleep exp=1:20 \
--download-archive $HOME/.archive.txt \
--geo-bypass-country US --user-agent "Mozilla/5.0 (X11; Linux x86_64; rv:141.0) Gecko/20100101 Firefox/141.0" \
--sub-format "ass/srt/best" --write-subs --write-auto-sub --sub-lang "en,fr,ar,qsm" --convert-subs vtt \
--downloader aria2c \
--downloader-args aria2c:"--continue=true --max-connection-per-server=3 --split=10 --min-split-size=5M --max-tries=10 --retry-wait=5" \
--prefer-ffmpeg --downloader-args ffmpeg:"-loglevel error -stats" --ppa "FFmpeg:-map_metadata -1" \
--replace-in-metadata "title,uploader" "[ _]" "-" \
--merge-output-format mp4 --remux-video mp4 \
-o "%(playlist_title).255B/%(playlist_index|3)03d - %(title).255B.%(ext)s" "urls"
#-o "Videos/%(title).255B.%(ext)s" "urls"
