#!/usr/bin/env bash

total=0

echo -e "Fichier\tDurée (s)"

for f in *.mp4; do
  # Extrait la durée en secondes (valeur flottante)
  duree=$(ffprobe -v error -show_entries format=duration \
    -of default=noprint_wrappers=1:nokey=1 "$f")
  # Affiche la durée individuelle
  printf "%s\t%.2f\n" "$f" "$duree"
  # Additionne
  total=$(echo "$total + $duree" | bc)
done

# Optionnel : Affichage total en h:m:s
heures=$(echo "$total/3600" | bc)
minutes=$(echo "($total%3600)/60" | bc)
secondes=$(echo "$total%60" | bc)
printf "\nDurée totale : %.2f secondes (%02d:%02d:%05.2f)\n" "$total" "$heures" "$minutes" "$secondes"
